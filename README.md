## Table of Contents

- [ğŸ“§ Phishing Email Detection with Explainable AI](#-phishing-email-detection-with-explainable-ai)
- [ğŸ“ Files](#-files)
- [ğŸ“Œ Project Overview](#-project-overview)
- [ğŸ“Š Dataset](#-dataset)
- [ğŸ§  Models](#-models)
  - [ğŸ”¹ MLP (TF-IDF + Feedforward Neural Network)](#-mlp)
  - [ğŸ”¹ RoBERTa (Transformer Fine-tuning)](#-roberta)
- [âš™ï¸ Training Pipeline](#ï¸-training-pipeline)
- [ğŸ“ˆ Performance Summary](#-performance-summary)
- [ğŸ’¡ Future Work: Explainability (XAI)](#-future-work)
- [ğŸ“ Repository Structure](#-repository-structure)

---

## ğŸ“§ Phishing Email Detection with Explainable AI


> **Safe AI Project Proposal**
> **Team 5 [ExplainSec]**   
> **20202905 Hyunmin Park (ë°•í˜„ë¯¼)**   
> **20200397 Seungjun You (ìœ ìŠ¹ì¤€)**   


This repository contains two machine learning models for detecting phishing emails, focusing on interpretability and robustness. The project compares a traditional MLP model with a state-of-the-art Transformer-based model (RoBERTa) using a real-world phishing dataset.

## ğŸ“ Files
- [`mlp.ipynb`](mlp.ipynb): Implements a lightweight and interpretable **Multilayer Perceptron (MLP)** model trained on TF-IDF vectors. The file provides detailed explanations of training, validation, and evaluation processes.
- [`roberta.ipynb`](roberta.ipynb): Fine-tunes a **pretrained RoBERTa** model from Hugging Face for phishing email classification. The file includes comprehensive descriptions of the training, validation, and evaluation steps.
- [`mlp_best.pt`](mlp_best.pt): **Saved model** for the MLP.  
- [`roberta-best.pt`](roberta-best.pt): **Saved model** for the fine-tuned RoBERTa.  
> **Note:** The RoBERTa model file (`roberta-best.pt`) is about 500MB and has been uploaded separately to eClass due to its large size.

## ğŸ“Œ Project Overview

Phishing emails have become increasingly sophisticated, often generated by AI models like ChatGPT. To combat these threats, we need not only accurate detectors but also **explainable models** that help human analysts understand why an email was flagged.

Our goal: **Build high-performing phishing detectors with explainability in mind.**

## ğŸ“Š Dataset

- Source: [Kaggle - Phishing Emails Dataset](https://www.kaggle.com/datasets/subhajournal/phishingemails)
- Samples: 18,650 emails (both phishing and legitimate)
- Task: Binary classification (1 = Safe, 0 = Phishing)  

## ğŸ§  Models

### ğŸ”¹ MLP 
- TF-IDF + Feedforward Neural Network
- Input: TF-IDF vectors
- Architecture: [128] â†’ [64] â†’ [1] (Sigmoid)
- Techniques: Dropout (0.4), L2 regularization, EarlyStopping
- Framework: PyTorch
- Threshold tuned to 0.45 for improved recall

### ğŸ”¹ RoBERTa 
- Transformer Fine-tuning
- Input: Raw text tokenized via `RobertaTokenizer`
- Base model: `roberta-base` from Hugging Face
- Output: Binary classification using `[CLS]` token
- Optimization: `AdamW`, EarlyStopping based on validation accuracy
- Framework: Transformers (Hugging Face) + PyTorch

## âš™ï¸ Training Pipeline

1. **Preprocessing**: Clean text, drop nulls/duplicates, label encode (safe=1, phishing=0)
2. **Feature Engineering**:
   - MLP â†’ TF-IDF vectorization
   - RoBERTa â†’ BPE tokenization
3. **Data Split**: 60% train / 20% val / 20% test (Stratified)
4. **Training**: Custom training loops with early stopping
5. **Evaluation**: Accuracy, F1-score, Confusion Matrix, Threshold tuning

## ğŸ“ˆ Performance Summary

<img alt="í”„ë¡œì íŠ¸ ê°œìš” ì´ë¯¸ì§€" src="https://github.com/user-attachments/assets/db38e575-0f51-4824-b89c-94b4e9af3122" style="max-width: 100%;" />

| Model   | Precision        | Recall       | F1 Score |
|---------|------------------|--------------|----------|
| MLP     | 0.96             | 0.98         | 0.96     |
| RoBERTa | 0.98             | 0.98         | 0.98     |


## ğŸ’¡ Future Work 

- Explainability (XAI)

We plan to apply SHAP and LIME to visualize how each model arrives at its decisions. This will:
- Highlight key words influencing classification
- Compare decision logic between MLP and RoBERTa
- Evaluate whether explanations are actionable for analysts

## ğŸ“ Repository Structure

ğŸ“¦ phishing-email-detection/    
â”œâ”€â”€ ğŸ“„ README.md                # Project description document   
â”œâ”€â”€ ğŸ“„ Phishing_Email.csv       # Original dataset from Kaggle   
â”œâ”€â”€ ğŸ“„ mlp.ipynb                # TF-IDF based MLP model training notebook    
â”œâ”€â”€ ğŸ“„ roberta.ipynb            # RoBERTa model fine-tuning notebook   
â”œâ”€â”€ ğŸ“„ mlp_best.pt              # Trained MLP model    
â”œâ”€â”€ ğŸ“„ roberta_best.pt          # Trained RoBERTa model **(file is large, available separately on eClass)**    

---

# ğŸ›¡ï¸ ì„¤ëª… ê°€ëŠ¥í•œ AI ê¸°ë°˜ í”¼ì‹± ì´ë©”ì¼ íƒì§€

ì´ ì €ì¥ì†ŒëŠ” í”¼ì‹± ì´ë©”ì¼ì„ íƒì§€í•˜ê¸° ìœ„í•œ ë‘ ê°€ì§€ ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ í¬í•¨í•˜ê³  ìˆìœ¼ë©°, í•´ì„ ê°€ëŠ¥ì„±ê³¼ ê²¬ê³ ì„±ì— ì¤‘ì ì„ ë‘ê³  ìˆìŠµë‹ˆë‹¤. ë³¸ í”„ë¡œì íŠ¸ëŠ” ì‹¤ì œ í”¼ì‹± ì´ë©”ì¼ ë°ì´í„°ì…‹ì„ í™œìš©í•˜ì—¬ ì „í†µì ì¸ MLP ëª¨ë¸ê³¼ ìµœì‹  íŠ¸ëœìŠ¤í¬ë¨¸ ê¸°ë°˜ RoBERTa ëª¨ë¸ì˜ ì„±ëŠ¥ì„ ë¹„êµí•©ë‹ˆë‹¤.

## ğŸ“ íŒŒì¼ êµ¬ì„±
- [`mlp.ipynb`](mlp.ipynb): TF-IDF ë²¡í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•™ìŠµëœ **ê²½ëŸ‰í™” ë° í•´ì„ ê°€ëŠ¥í•œ MLP(ë‹¤ì¸µ í¼ì…‰íŠ¸ë¡ )** ëª¨ë¸ì„ êµ¬í˜„í•©ë‹ˆë‹¤. ì´ íŒŒì¼ì—ëŠ” í•™ìŠµ, ê²€ì¦, í‰ê°€ ê³¼ì •ì´ ìì„¸íˆ ì„¤ëª…ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
- [`roberta.ipynb`](roberta.ipynb): Hugging Faceì˜ ì‚¬ì „í•™ìŠµëœ **RoBERTa** ëª¨ë¸ì„ í”¼ì‹± ì´ë©”ì¼ ë¶„ë¥˜ì— ë§ê²Œ ë¯¸ì„¸ì¡°ì •í•©ë‹ˆë‹¤. ì´ íŒŒì¼ì—ëŠ” í•™ìŠµ, ê²€ì¦, í‰ê°€ ì ˆì°¨ê°€ ìƒì„¸í•˜ê²Œ ì•ˆë‚´ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
- [`mlp_best.pt`](mlp_best.pt): **MLP ëª¨ë¸ì´ ì €ì¥ëœ íŒŒì¼**ì…ë‹ˆë‹¤.  
- [`roberta-best.pt`](roberta-best.pt): **ë¯¸ì„¸ì¡°ì •ëœ RoBERTa ëª¨ë¸ì´ ì €ì¥ëœ íŒŒì¼**ì…ë‹ˆë‹¤.  
> **ì°¸ê³ :** RoBERTa ëª¨ë¸ íŒŒì¼(`roberta-best.pt`)ì€ ì•½ 500MBë¡œ, íŒŒì¼ í¬ê¸°ê°€ ì»¤ì„œ eClassì— ë³„ë„ë¡œ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.

## ğŸ“Œ í”„ë¡œì íŠ¸ ê°œìš”

ìµœê·¼ í”¼ì‹± ì´ë©”ì¼ì€ ChatGPTì™€ ê°™ì€ AI ëª¨ë¸ë¡œ ìƒì„±ë˜ëŠ” ë“± ì ì  ë” ì •êµí•´ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ìœ„í˜‘ì— ëŒ€ì‘í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¨ìˆœíˆ ì •í™•í•œ íƒì§€ê¸°ë¿ë§Œ ì•„ë‹ˆë¼, ì´ë©”ì¼ì´ ì™œ íƒì§€ë˜ì—ˆëŠ”ì§€ ì¸ê°„ ë¶„ì„ê°€ê°€ ì´í•´í•  ìˆ˜ ìˆë„ë¡ **ì„¤ëª… ê°€ëŠ¥í•œ ëª¨ë¸**ì´ í•„ìš”í•©ë‹ˆë‹¤.

ìš°ë¦¬ì˜ ëª©í‘œ: **ì„¤ëª… ê°€ëŠ¥ì„±ì„ ê°–ì¶˜ ê³ ì„±ëŠ¥ í”¼ì‹± íƒì§€ê¸° ê°œë°œ**

## ğŸ“Š ë°ì´í„°ì…‹

- ì¶œì²˜: [Kaggle - Phishing Emails Dataset](https://www.kaggle.com/datasets/subhajournal/phishingemails)
- ìƒ˜í”Œ ìˆ˜: 18,650ê°œ ì´ë©”ì¼(í”¼ì‹± ë° ì •ìƒ í¬í•¨)
- íƒœìŠ¤í¬: ì´ì§„ ë¶„ë¥˜ (1 = ì •ìƒ, 0 = í”¼ì‹±)  
  **(safe=1, phishing=0)**

## ğŸ§  ëª¨ë¸

### ğŸ”¹ MLP 
- TF-IDF + í”¼ë“œí¬ì›Œë“œ ì‹ ê²½ë§
- ì…ë ¥: TF-IDF ë²¡í„°
- ì•„í‚¤í…ì²˜: [128] â†’ [64] â†’ [1] (ì‹œê·¸ëª¨ì´ë“œ)
- ê¸°ë²•: ë“œë¡­ì•„ì›ƒ(0.4), L2 ì •ê·œí™”, EarlyStopping
- í”„ë ˆì„ì›Œí¬: PyTorch
- ì„ê³„ê°’(threshold) 0.45ë¡œ ë¦¬ì½œ í–¥ìƒ

### ğŸ”¹ RoBERTa 
- íŠ¸ëœìŠ¤í¬ë¨¸ íŒŒì¸íŠœë‹
- ì…ë ¥: `RobertaTokenizer`ë¡œ í† í¬ë‚˜ì´ì¦ˆëœ ì›ë³¸ í…ìŠ¤íŠ¸
- ê¸°ë°˜ ëª¨ë¸: Hugging Faceì˜ `roberta-base`
- ì¶œë ¥: `[CLS]` í† í°ì„ í™œìš©í•œ ì´ì§„ ë¶„ë¥˜
- ìµœì í™”: `AdamW`, ê²€ì¦ ì •í™•ë„ ê¸°ë°˜ EarlyStopping
- í”„ë ˆì„ì›Œí¬: Transformers(Hugging Face) + PyTorch

## âš™ï¸ í•™ìŠµ íŒŒì´í”„ë¼ì¸

1. **ì „ì²˜ë¦¬**: í…ìŠ¤íŠ¸ ì •ì œ, ê²°ì¸¡/ì¤‘ë³µ ì œê±°, ë¼ë²¨ ì¸ì½”ë”© (ì •ìƒ=1, í”¼ì‹±=0)
2. **íŠ¹ì„± ì—”ì§€ë‹ˆì–´ë§**:
   - MLP â†’ TF-IDF ë²¡í„°í™”
   - RoBERTa â†’ BPE í† í¬ë‚˜ì´ì¦ˆ
3. **ë°ì´í„° ë¶„í• **: í•™ìŠµ 60% / ê²€ì¦ 20% / í…ŒìŠ¤íŠ¸ 20% (ì¸µí™” ì¶”ì¶œ)
4. **í•™ìŠµ**: EarlyStoppingì´ ì ìš©ëœ ì»¤ìŠ¤í…€ í•™ìŠµ ë£¨í”„
5. **í‰ê°€**: ì •í™•ë„, F1-score, í˜¼ë™í–‰ë ¬, ì„ê³„ê°’ íŠœë‹

## ğŸ“ˆ ì„±ëŠ¥ ìš”ì•½

<img alt="í”„ë¡œì íŠ¸ ê°œìš” ì´ë¯¸ì§€" src="https://github.com/user-attachments/assets/db38e575-0f51-4824-b89c-94b4e9af3122" style="max-width: 100%;" />

| ëª¨ë¸    | ì •ë°€ë„ | ì¬í˜„ìœ¨ | F1 ì ìˆ˜ |
|---------|--------------|-------------|---------|
| MLP     | 0.96         | 0.98        | 0.96    |
| RoBERTa | 0.98         | 0.98        | 0.98    |

## ğŸ’¡ í–¥í›„ ê³„íš 

- ì„¤ëª… ê°€ëŠ¥í•œ ì¸ê³µì§€ëŠ¥(XAI)

SHAP ë° LIMEì„ ì ìš©í•˜ì—¬ ê° ëª¨ë¸ì´ ì–´ë–»ê²Œ ì˜ì‚¬ê²°ì •ì„ ë‚´ë¦¬ëŠ”ì§€ ì‹œê°í™”í•  ì˜ˆì •ì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´:
- ë¶„ë¥˜ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ì£¼ìš” ë‹¨ì–´ë¥¼ í•˜ì´ë¼ì´íŠ¸
- MLPì™€ RoBERTaì˜ ì˜ì‚¬ê²°ì • ë…¼ë¦¬ ë¹„êµ
- ë¶„ì„ê°€ê°€ í™œìš© ê°€ëŠ¥í•œ ì„¤ëª…ì¸ì§€ í‰ê°€

## ğŸ“ ì €ì¥ì†Œ êµ¬ì¡°

ğŸ“¦ phishing-email-detection/      
â”œâ”€â”€ ğŸ“„ README.md                # í”„ë¡œì íŠ¸ ì„¤ëª… ë¬¸ì„œ   
â”œâ”€â”€ ğŸ“„ Phishing_Email.csv       # Kaggleì—ì„œ ë°›ì€ ì›ë³¸ ë°ì´í„°ì…‹   
â”œâ”€â”€ ğŸ“„ mlp.ipynb                # TF-IDF ê¸°ë°˜ MLP ëª¨ë¸ í•™ìŠµ ë…¸íŠ¸ë¶  
â”œâ”€â”€ ğŸ“„ roberta.ipynb            # RoBERTa ëª¨ë¸ íŒŒì¸íŠœë‹ ë…¸íŠ¸ë¶  
â”œâ”€â”€ ğŸ“„ mlp_best.pt              # í•™ìŠµëœ MLP ëª¨ë¸   
â”œâ”€â”€ ğŸ“„ roberta_best.pt          # í•™ìŠµëœ RoBERTa ëª¨ë¸ ê°€ì¤‘ì¹˜ (ìš©ëŸ‰ì´ ì»¤ì„œ Eclassì— ì—…ë¡œë“œí•¨)   